pkgname=axum-website-rack
pkgver=git
pkgrel=4
pkgdesc="Axum Website for the I/O rack"
url="http://192.168.0.9/"
arch=(i686)
depends=('perl' 'fcgi' 'perl-fcgi' 'perl-dbi' 'perl-dbd-pg' 'lighttpd' 'postgresql-libs' 'axum-processes-rack>=git-3')
backup=()
license=('GPL')

source=()
gitroot="git@192.168.0.9:"

build() {
  # git repo
  cd "$srcdir"
  if [ -d g/.git ]; then
    (cd g && git pull "${gitroot}axum-website-rack.git" master && git reset --hard)
  else
    git clone "${gitroot}axum-website-rack.git" g
  fi

  # Arch scripts & config
  install -m 755 -d "$pkgdir/www"
  install -m 755 -d "$pkgdir/etc/rc.d"
  install -m 755 -d "$pkgdir/etc/logrotate.d"
  install -m 755 -d "$pkgdir/etc/lighttpd" 
  install -m 644 "$startdir/YAWF.logrotate" "$pkgdir/etc/logrotate.d/YAWF"
  install -m 644 "$startdir/lighttpd.conf" "$pkgdir/etc/lighttpd/lighttpd_axum_website.conf"

  # install webfiles
  cp -r g/* "$pkgdir/www"
  # dsp firmware files
#  mkdir "$srcdir/dsp"
#  cd "$srcdir/dsp"
#  scp "${gitroot}additional-files/dsp/*" .
#  install -m 755 -d "$pkgdir/var/lib/axum/dsp"
#  install -m 644 -t "$pkgdir/var/lib/axum/dsp" *
}

